<%- include('./partials/headerDashboard')%>
<%function ellipsify (str) {
    if (str.length > 140) {
        return (str.substring(0, 138) + "...");
    }
    else {
        return str;
    }
  }%>
<link rel="stylesheet" href="/assets/css/eliminaPost.css">


<body onload="startTime()">
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand" href="#">Villa Bersezio&nbsp;</a>
        <a class="navbar-brand" id="admin-cockpit" href="#"><b>| </b>&nbsp;&nbsp;Administration Cockpit</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item active">
                    <a class="nav-link first" href="dashboard"><i class="fas fa-home"></i> Home <span
                            class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item second">
                    <a class="nav-link" href="/admin/creaPost"><i class="fas fa-plus"></i>&nbsp;Crea Post</a>
                </li>
                <li class="nav-item third">
                    <a class="nav-link" href="/admin/modificaPost"><i class="fas fa-pen"></i>&nbsp;Modifica Post</a>
                </li>
                <li class="nav-item fourth">
                    <a class="nav-link" href="/admin/eliminaPost"><i class="fas fa-trash"></i>&nbsp;Elimina Post</a>
                </li>
                <li class="nav-item fifth">
                    <a class="nav-link" href="/admin/tuttiPost"><i class="fas fa-book"></i>&nbsp;Storico Post</a>
                </li>
                <li class="nav-item profile">
                    <div class="dropdown" style="padding-top: -10px !important;">
                      <button class="btn dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <img id="rotation"  style="width: 30px; height: 30px;" src="/assets/img/sgarbi.png" alt="profile-dropdown">
                      </button>
                      <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                        <a class="dropdown-item dropdown-profile" style="font-size: 15px;" href=/admin/profile"><i class="fas fa-user-circle"></i> Profilo</a>
                        <a class="dropdown-item dropdown-exit" style="font-size: 15px;" href="/admin/logout"><i class="fas fa-sign-out-alt"></i> Esci</a>
                      </div>
                    </div>
                  </li>
            </ul>
        </div>
    </nav>




    <div class="container-fluid" style="padding: 20px 20px 20px 20px;">
    <div class="row" align="center">

      <% Post.forEach((Post, index) =>{%>
      <div class="col">
        <div class="card" style="width: 18rem;">
          <img class="card-img-top" src="https://source.unsplash.com/1600x900/?nature,water" alt="Card image cap">
          <i class="fas fa-clock"></i>
          <h6 id="text-clock"><%=Post.Uploaded%></h6>
          <%if (Post.Date){%>
          <i class="fas fa-calendar"></i>
          <h6 id="text-calendar"><%=Post.Date%></h6><%}%>
          <h5 class="card-title"><%=Post.Title%></h5>

          <div class="card-body">

            <p class="card-text"><%=ellipsify(Post.Content)%></p>
            <!-- Button trigger modal -->
            <button type="button" align="center" class="btn" id="btn-delete" data-toggle="modal"
                            data-target="#modal" data-request="<%=Post._id%>">                           
                            Elimina
                        </button>
          </div>
          

              </div>
            </div>
   
 
            
<%})%>
</div>
</div>
<div class="modal" id="modal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h1 style="opacity: 0.8; font-family: 'Abril Fatface', cursive !important; font-size: 150%; text-shadow: 0px 0px 12px #777;"
                    class="modal-title">Elimina Post</h1>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>Cliccando sul tasto <b>Elimina</b> andrà ad eliminare irreversibilmente il post selezionato.</p>
            </div>
            <div class="modal-footer">  
                <a type="button" id="delete-btn" class="btn" href="/admin/eliminapost/<%=Post._id%>">Elimina</a>
                <a type="button" id="discard-btn" class="btn" data-dismiss="modal">Annulla</a>
            </div>
        </div>
    </div>
</div>
<script>
    $('#modal').on('show.bs.modal', function (event) {
    console.log('albanese')
    var button = $(event.relatedTarget) // Button that triggered the modal
    var recipient = button.data('request') // Extract info from data-* attributes
    // If necessary, you could initiate an AJAX request here (and then do the updating in a callback).
    // Update the modal's content. We'll use jQuery here, but you could use a data binding library or other methods instead.
    var modal = $(this)
    console.log(modal);
    // modal.find('.modal-title').text('New message to ' + recipient)
    // modal.find('.modal-body input').val(recipient)
  })
</script>
    

    <footer style="padding-top: 30px;">
        <h6 style="text-align: center; font-size: 80%; font-family: 'Montserrat'; font-weight: 200; color: #000;">
            <b>© All
                rights Reserved to the OmniaStudios</b></h6>
    </footer>
    <script src="script.js"></script>

</body>
<%- include('./partials/footerDashboard')%>
